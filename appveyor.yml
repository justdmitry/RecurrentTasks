version: N{build}
configuration: Debug
image: Visual Studio 2022

# net10 workaround from https://github.com/appveyor/ci/issues/3984
install:
- ps: |
    Invoke-WebRequest -Uri 'https://dot.net/v1/dotnet-install.ps1' -UseBasicParsing -OutFile "$env:temp\dotnet-install.ps1"
    & $env:temp\dotnet-install.ps1 -Architecture x64 -Version '10.0.100' -InstallDir "$env:ProgramFiles\dotnet"

before_build:
- cmd: dotnet restore

build:
  verbosity: minimal

test_script:
- ps: ./testpublishreport.ps1
